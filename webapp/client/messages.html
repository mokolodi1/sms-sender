<template name="messages">
  <h1>Messages</h1>

  <h3>Compose</h3>
  {{#if contactsCount}}
    {{#autoForm id="insertMessage" collection=Messages}}
      {{> horizontalField name="english_message" type="textarea" rows=3
          placeholder="English message"}}
      {{> horizontalField name="spanish_message" type="textarea" rows=3
          placeholder="Spanish message"}}

      <div class="form-group">
        <button type="submit" onclick="return true;//confirm('Are you sure?')"
            class="btn btn-primary">
            Send SMS to {{contactsCount}}
            {{#if compare contactsCount 1}}
              contact
            {{else}}
              contacts
            {{/if}}
          </button>
        <button type="reset" class="btn btn-default">Reset</button>
      </div>
    {{/autoForm}}
  {{else}}
    <div class="alert alert-info" style="display: inline-block;">
      You have to have at least one contact registered before sending messages.
      <a href="{{pathFor "contacts"}}" class="btn btn-primary">Add contacts</a>
    </div>
  {{/if}}

  <h3>Past messages</h3>
  {{#if length getMessages}}
    <div class="list-group">
      {{#each getMessages}}
        <div class="list-group-item">
          <h4 class="list-group-item-heading">
            {{fromNow}}
            <span class="badge pull-right">{{status}}</span>
          </h4>
          <p class="list-group-item-text">English: {{english_message}}</p>
          <p class="list-group-item-text">Spanish: {{spanish_message}}</p>
        </div>
      {{/each}}
    </div>
  {{else}}
    <div class="well">
      Use the form above to send your first SMS!
    </div>
  {{/if}}
</template>

<!-- also used in contacts template -->
<template name="horizontalField">
  {{! "if options" important becuase if options is specified and is null,
      it overrides the implied options of the schema}}
  {{#if options}}
    {{> afQuickField name=name
        type=type
        options=options
        firstOption=firstOption
        template="bootstrap3-horizontal"
        label-class=horizontalLabelClass
        input-col-class=horizontalInputColClass
        placeholder=placeholder
        rows=rows
        class=class}}
  {{else}}
    {{> afQuickField name=name
        type=type
        firstOption=firstOption
        template="bootstrap3-horizontal"
        label-class=horizontalLabelClass
        input-col-class=horizontalInputColClass
        placeholder=placeholder
        rows=rows
        class=class}}
  {{/if}}
</template>
